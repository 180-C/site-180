<!-- Help the browser prioritize those resources -->
<link rel="preload" as="image" href="{{ "images/map_marker.png" | absURL }}"></link>
<link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/ol@10.7.0/dist/ol.min.js"></link>
<link rel="preload" as="script" href="https://code.jquery.com/jquery-3.6.0.min.js"></link>

<script src="https://cdn.jsdelivr.net/npm/ol@10.7.0/dist/ol.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- crieur map -->
{{ $crieur := resources.Get "js/map.js" }}
{{ if hugo.IsProduction }}
  {{ $crieur = $crieur | minify | fingerprint }}
{{ end }}
<script
  crossorigin="anonymous"
  integrity="{{ $crieur.Data.Integrity }}"
  src="{{ $crieur.RelPermalink }}"
  defer
></script>

<script type="text/javascript">
  {{ $config := index $.Site.Data "config-crieur" | default (dict) }}

  const CRIEUR_CONFIG = {{ $config }};

  // list all pages of type "crieur"
  const CRIEUR_PLACES = [
    {{ with $.Site.GetPage "crieur" }}
  {{ $places := .Pages }}
    {{ range $i, $place := $places }}
      {{ $originalPlace := $place.Params }}
      {{ $placeWithUrl := dict "url" ($place.RelPermalink | relURL ) }}
      {{ $place = merge $originalPlace $placeWithUrl }}
      {{ $place }},
    {{ end }}
  {{ end }}
  ];

  const MAP_MARKER = '{{ "images/map_marker.png" | absURL }}';

</script>
